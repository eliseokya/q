# Development image with full Rust toolchain
FROM rust:1.75

# Install additional development tools
RUN apt-get update && apt-get install -y \
    pkg-config \
    libssl-dev \
    jq \
    vim \
    less \
    make \
    && rm -rf /var/lib/apt/lists/*

# Install cargo tools
RUN cargo install cargo-watch cargo-expand

# Create non-root user for development
RUN useradd -m -u 1000 -s /bin/bash developer

# Create workspace directory
RUN mkdir -p /workspace && chown developer:developer /workspace

# Switch to non-root user
USER developer

# Set workspace
WORKDIR /workspace

# Configure cargo for better output
ENV CARGO_TERM_COLOR=always
ENV RUST_BACKTRACE=1

# Default to bash
CMD ["/bin/bash"]